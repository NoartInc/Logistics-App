var _=Object.defineProperty,O=Object.defineProperties;var J=Object.getOwnPropertyDescriptors;var z=Object.getOwnPropertySymbols;var V=Object.prototype.hasOwnProperty,$=Object.prototype.propertyIsEnumerable;var W=(i,r,l)=>r in i?_(i,r,{enumerable:!0,configurable:!0,writable:!0,value:l}):i[r]=l,x=(i,r)=>{for(var l in r||(r={}))V.call(r,l)&&W(i,l,r[l]);if(z)for(var l of z(r))$.call(r,l)&&W(i,l,r[l]);return i},f=(i,r)=>O(i,J(r));import{b as P,c as L,d as p,a as e,j as s,F as j}from"./vendor.057b80fe.js";import{e as K,u as q,a as Q,r as B,b as X,d as Z,f as ee,h as te}from"./pengiriman-action.bbd84ffc.js";import{S as ae,u as H,R as E}from"./constants.091680d7.js";import{S as se}from"./react-select.esm.ee56aae7.js";import{r as re}from"./teli-action.2461e862.js";import{a as le}from"./http-common.c2a35339.js";import{r as D,S as ne,a as oe,b as ie,B as A,P as I,C as de,c as ce,d as ue,e as me}from"./Icons.cdb9d418.js";import{c as pe}from"./index.f71ab816.js";import{h as U}from"./moment.d3763ddf.js";import"./setPrototypeOf.08579ea5.js";const ge=({onChange:i=null,value:r=null})=>{const l=P(),c=L(t=>t.telis.list).map(t=>({value:t.id,label:t.fullName})),m=t=>{i({target:{name:"teli",value:t}})};return p.exports.useEffect(()=>{l(re())},[]),e(se,{onChange:m,type:"text",id:"teli",name:"teli",className:"mt-1 block w-full border border-gray-300 bg-white rounded-md shadow-sm focus:outline-none focus:ring-gray-500 focus:border-gray-500 sm:text-sm",placeholder:"Choose Teli",options:c,defaultValue:c[""],isMulti:!0})};function he({id:i=null,status:r}){var v;const[l,c]=p.exports.useState(!1),m=P(),t=L(d=>d.pengirimans.selectedData),{user:o}=H,[a,n]=p.exports.useState({});p.exports.useEffect(()=>{n(t)},[t]);const h=d=>{n(g=>f(x({},g),{id:d})),m(K(d)),c(!0)},y=d=>{const{name:g,value:w}=d.target;n(C=>f(x({},C),{[g]:w}))},k=d=>{let g=new FormData;return g.append("photo",d.target.files[0]),le.post("/upload",g,{headers:{"Content-Type":"multipart/form-data"}}).then(w=>{n(C=>f(x({},C),{image:w.data.image}))})};return s(j,{children:[e("svg",{type:"button",onClick:()=>h(i),xmlns:"http://www.w3.org/2000/svg",className:"w-6 h-6 text-blue-400 cursor-pointer",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})}),l?e(j,{children:s("form",{onSubmit:d=>{d.preventDefault(),m(q(a)),c(!1)},children:[e("div",{className:"justify-center items-center flex overflow-x-hidden overflow-y-auto fixed inset-0 z-50 outline-none focus:outline-none",children:e("div",{className:"relative w-auto my-6 mx-auto max-w-4xl",children:s("div",{className:"border-0 rounded-lg shadow-lg relative flex flex-col w-full bg-white outline-none focus:outline-none",children:[s("div",{className:"flex items-start justify-between p-4 border-b border-solid border-slate-200 rounded-t",children:[e("h3",{className:"text-xl font-semibold uppercase",children:"Update Progress"}),e("button",{className:"p-1 ml-auto bg-transparent border-0  float-right text-3xl leading-none font-semibold outline-none focus:outline-none",onClick:()=>c(!1),children:e("svg",{className:"w-6 h-6",fill:"none",stroke:"#808080",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:e("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})})]}),e("div",{className:"mt-5 md:mt-0 md:col-span-4",children:s("div",{className:"grid grid-cols-6 px-4 py-4",children:[s("div",{className:"mb-3 col-span-6 sm:col-span-6",children:[s("label",{for:"status",className:"block text-xs font-medium uppercase text-gray-500",children:["Update Progress",e("span",{className:"text-red-600",children:"*"})]}),s("select",{onChange:y,id:"status",name:"status",className:"mt-1 block w-96 py-2 px-3 cursor-pointer border border-gray-300 bg-white rounded-md shadow-sm focus:outline-none focus:ring-gray-500 focus:border-gray-500 sm:text-sm",value:a==null?void 0:a.status,children:[e("option",{value:"",children:"---Pilih Status---"}),(v=ae[o==null?void 0:o.role])==null?void 0:v.map(({value:d,key:g})=>e("option",{value:g,children:d},g))]})]}),((a==null?void 0:a.status)==="terkirim"||(a==null?void 0:a.status)==="pending"||(a==null?void 0:a.status)==="cancel")&&s("div",{className:"mb-3 col-span-6 sm:col-span-6",children:[e("label",{for:"note",className:"block text-xs font-medium uppercase text-gray-500",children:"Note"}),e("textarea",{onChange:y,type:"text",name:"note",id:"note",rows:"4",className:"mt-1 focus:ring-indigo-500 focus:border-indigo-500 block w-full shadow-sm sm:text-sm border-gray-300 rounded-md",placeholder:"Masukan pesan disini ..",value:a==null?void 0:a.note})]}),((a==null?void 0:a.status)==="terkirim"||(a==null?void 0:a.status)==="pending")&&s(j,{children:[s("div",{className:"mb-3 col-span-6 sm:col-span-6",children:[e("label",{for:"img",className:"block text-xs font-medium uppercase text-gray-500",children:"Submit Surat Jalan"}),e("input",{className:"mt-1 block w-96 py-2 px-3 text-base text-gray-900 bg-gray-50 rounded-lg border border-gray-400 cursor-pointer focus:outline-none",id:"formFile",type:"file",name:"image",accept:"image/*",onChange:k})]}),a.image&&e("img",{src:a.image,alt:"image"})]}),(a==null?void 0:a.status)==="dimuat"&&s("div",{className:"mb-3 col-span-6 sm:col-span-6",children:[e("label",{for:"teli",className:"block text-xs font-medium uppercase text-gray-500",children:"Teli"}),e(ge,{onChange:y,value:a==null?void 0:a.teli})]})]})}),s("div",{className:"flex items-center justify-end p-3 border-t border-solid border-slate-200 rounded-b",children:[e("button",{className:"bg-emerald-500 text-white active:bg-emerald-600 hover:bg-emerald-700 font-bold uppercase text-sm px-6 py-3 rounded shadow hover:shadow-lg outline-none focus:outline-none mr-1 mb-1 ease-linear transition-all duration-150",type:"submit",children:"Update"}),e("button",{className:"text-gray-500 background-transparent hover:bg-gray-200 font-bold uppercase px-6 py-3 rounded text-sm outline-none focus:outline-none mr-1 mb-1 ease-linear transition-all duration-150",type:"cancel",onClick:()=>c(!1),children:"Cancel"})]})]})})}),e("div",{className:"opacity-25 fixed inset-0 z-40 bg-black"})]})}):null]})}function be(){const[i,r]=p.exports.useState(!1),[l,c]=p.exports.useState(""),[m,t]=p.exports.useState(""),o=P();p.exports.useEffect(()=>{c(U().format("YYYY-MM-DD")),t(U().add(1,"days").format("YYYY-MM-DD"))},[]);const a=()=>{o(Q(l,m)),r(!1)};return s(j,{children:[e("button",{type:"button",onClick:()=>r(!0),className:"inline-block px-6 py-2.5 bg-blue-600 text-white font-medium text-xs leading-tight uppercase rounded shadow-md hover:bg-blue-700 hover:shadow-lg focus:bg-blue-700 focus:shadow-lg focus:outline-none focus:ring-0 active:bg-blue-800 active:shadow-lg transition duration-150 ease-in-out","data-bs-toggle":"modal","data-bs-target":"#exampleModalLg",children:"Export Data"}),i?s(j,{children:[e("div",{className:"justify-center items-center flex overflow-x-hidden overflow-y-auto fixed inset-0 z-50 outline-none focus:outline-none",children:e("div",{className:"relative w-auto my-6 mx-auto max-w-4xl",children:s("div",{className:"border-0 rounded-lg shadow-lg relative flex flex-col w-full bg-white outline-none focus:outline-none",children:[s("div",{className:"flex items-start justify-between p-4 border-b border-solid border-slate-200 rounded-t",children:[e("h3",{className:"text-lg font-semibold uppercase",children:"Export to csv"}),e("button",{className:"p-1 ml-auto bg-transparent border-0  float-right text-3xl leading-none font-semibold outline-none focus:outline-none",onClick:()=>r(!1),children:e("svg",{className:"w-6 h-6",fill:"none",stroke:"#808080",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg",children:e("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})})})]}),s("div",{className:"flex items-center px-4 py-4",children:[e("div",{className:"relative",children:e("input",{name:"start",type:"date",value:l,id:"dateRangePickerId",onChange:n=>c(n.target.value),className:"bg-gray-50 border border-gray-300 text-gray-900 sm:text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full pl-10 p-2.5 datepicker-input",placeholder:"Select date start"})}),e("span",{className:"mx-4 text-gray-500",children:"to"}),e("div",{className:"relative",children:e("input",{name:"end",type:"date",value:m,min:l,onChange:n=>t(n.target.value),className:"bg-gray-50 border border-gray-300 text-gray-900 sm:text-sm rounded-lg focus:ring-blue-500 focus:border-blue-500 block w-full pl-10 p-2.5 datepicker-input",placeholder:"Select date end"})})]}),s("div",{className:"flex items-center justify-end p-3 border-t border-solid border-slate-200 rounded-b",children:[e("button",{className:"bg-emerald-500 text-white active:bg-emerald-600 hover:bg-emerald-700 font-bold uppercase text-sm px-6 py-3 rounded shadow hover:shadow-lg outline-none focus:outline-none mr-1 mb-1 ease-linear transition-all duration-150",type:"submit",onClick:()=>a(),children:"Export"}),e("button",{className:"text-gray-500 background-transparent hover:bg-gray-200 font-bold uppercase px-6 py-3 rounded text-sm outline-none focus:outline-none mr-1 mb-1 ease-linear transition-all duration-150",type:"button",onClick:()=>r(!1),children:"Close"})]})]})})}),e("div",{className:"opacity-25 fixed inset-0 z-40 bg-black"})]}):null]})}function xe({preGlobalFilteredRows:i,globalFilter:r,setGlobalFilter:l}){const c=P(),m=i.length,[t,o]=p.exports.useState(r),a=D.exports.useAsyncDebounce(n=>{l(n||void 0),c(ee(n))},200);return s("label",{className:"flex gap-x-2 items-baseline",children:[e("span",{className:"text-gray-700",children:"Search: "}),e("input",{type:"text",className:"rounded-md border-gray-300 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50",value:t||"",onChange:n=>{o(n.target.value),a(n.target.value)},placeholder:`${m} records...`})]})}function fe({value:i}){const r=i?i.toLowerCase():"unknown";return e("span",{className:pe("px-3 py-1 uppercase leading-wide font-bold text-xs rounded-full shadow-sm",r.startsWith("diproses")?"bg-green-100 text-green-800":null,r.startsWith("dimuat")?"bg-green-100 text-green-800":null,r.startsWith("termuat")?"bg-green-100 text-green-800":null,r.startsWith("dikirim")?"bg-green-100 text-green-800":null,r.startsWith("terkirim")?"bg-gray-400 text-white":null,r.startsWith("pending")?"bg-yellow-100 text-yellow-800":null,r.startsWith("cancel")?"bg-red-100 text-red-800":null),children:r})}function ve({columns:i,data:r}){const l=P(),{pageCount:c,pageSize:m,page:t,search:o}=L(u=>u.pengirimans),{getTableProps:a,getTableBodyProps:n,headerGroups:h,prepareRow:y,page:k,canPreviousPage:N,canNextPage:v,pageOptions:d,pageCount:g,gotoPage:w,nextPage:C,previousPage:T,setPageSize:R,state:S,preGlobalFilteredRows:Y,setGlobalFilter:G}=D.exports.useTable({columns:i,data:r,initialState:{pageIndex:t-1,pageSize:m},manualPagination:!0,pageCount:c},D.exports.useFilters,D.exports.useGlobalFilter,D.exports.useSortBy,D.exports.usePagination),{user:F}=H;return p.exports.useEffect(()=>{R(m)},[]),p.exports.useEffect(()=>{l(B())},[t,m,o]),p.exports.useEffect(()=>{l(X(S.pageIndex))},[S.pageIndex]),p.exports.useEffect(()=>{l(Z(S.pageSize))},[S.pageSize]),e(j,{children:e("div",{className:"shadow overflow-hidden sm:rounded-md",children:s("div",{className:"px-4 py-5 bg-white sm:p-6",children:[e("header",{className:"px-0 mt-0 mb-4",children:e("h2",{className:"font-semibold text-slate-800 uppercase",children:"Pengiriman List"})}),s("div",{className:"sm:flex sm:gap-x-2 py-2 justify-between",children:[e(xe,{preGlobalFilteredRows:Y,globalFilter:o,setGlobalFilter:G}),h.map(u=>u.headers.map(b=>b.Filter?e("div",{className:"mt-2 sm:mt-0",children:b.render("Filter")},b.id):null)),e("div",{className:"flex",children:E.export_pengiriman.allowedRoles.includes(F==null?void 0:F.role)&&e(be,{})})]}),e("div",{className:"mt-4 flex flex-col",children:e("div",{className:"-my-2 overflow-x-auto -mx-4 sm:-mx-6 lg:-mx-8",children:e("div",{className:"py-2 align-middle inline-block min-w-full sm:px-6 lg:px-8",children:e("div",{className:"shadow overflow-hidden border-b border-gray-200 sm:rounded-lg",children:s("table",f(x({},a()),{className:"min-w-full divide-y divide-gray-200",children:[e("thead",{className:"bg-gray-50",children:h.map(u=>e("tr",f(x({},u.getHeaderGroupProps()),{children:u.headers.map(b=>e("th",f(x({scope:"col",className:"group px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider"},b.getHeaderProps(b.getSortByToggleProps())),{children:s("div",{className:"flex items-center justify-between",children:[b.render("Header"),e("span",{children:b.isSorted?b.isSortedDesc?e(ne,{className:"w-4 h-4 text-gray-400"}):e(oe,{className:"w-4 h-4 text-gray-400"}):e(ie,{className:"w-4 h-4 text-gray-400 opacity-0 group-hover:opacity-100"})})]})})))})))}),e("tbody",f(x({},n()),{className:"bg-white divide-y divide-gray-200",children:k.map((u,b)=>(y(u),e("tr",f(x({className:"odd:bg-white even:bg-slate-100"},u.getRowProps()),{children:u.cells.map(M=>e("td",f(x({},M.getCellProps()),{className:"px-6 py-2 whitespace-nowrap",role:"cell",children:M.column.Cell.name==="defaultRenderer"?e("div",{className:"text-sm text-gray-500",children:M.render("Cell")}):M.render("Cell")})))}))))}))]}))})})})}),s("div",{className:"py-3 flex items-center justify-between",children:[s("div",{className:"flex-1 flex justify-between sm:hidden",children:[e(A,{onClick:()=>T(),disabled:!N,children:"Previous"}),e(A,{onClick:()=>C(),disabled:!v,children:"Next"})]}),s("div",{className:"hidden sm:flex-1 sm:flex sm:items-center sm:justify-between",children:[s("div",{className:"flex gap-x-2 items-baseline",children:[s("span",{className:"text-sm text-gray-700",children:["Page"," ",e("span",{className:"font-medium",children:S.pageIndex+1})," of"," ",e("span",{className:"font-medium",children:d.length})]}),s("label",{children:[e("span",{className:"sr-only",children:"Items Per Page"}),e("select",{className:"mt-1 block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-300 focus:ring focus:ring-indigo-200 focus:ring-opacity-50",value:S.pageSize,onChange:u=>{R(Number(u.target.value))},children:[25,50,100].map(u=>s("option",{value:u,children:["Show ",u]},u))})]})]}),e("div",{children:s("nav",{className:"relative z-0 inline-flex rounded-md shadow-sm -space-x-px","aria-label":"Pagination",children:[s(I,{className:"rounded-l-md",onClick:()=>w(0),disabled:!N,children:[e("span",{className:"sr-only",children:"First"}),e(de,{className:"h-5 w-5 text-gray-400","aria-hidden":"true"})]}),s(I,{onClick:()=>T(),disabled:!N,children:[e("span",{className:"sr-only",children:"Previous"}),e(ce,{className:"h-5 w-5 text-gray-400","aria-hidden":"true"})]}),s(I,{onClick:()=>C(),disabled:!v,children:[e("span",{className:"sr-only",children:"Next"}),e(ue,{className:"h-5 w-5 text-gray-400","aria-hidden":"true"})]}),s(I,{className:"rounded-r-md",onClick:()=>w(g-1),disabled:!v,children:[e("span",{className:"sr-only",children:"Last"}),e(me,{className:"h-5 w-5 text-gray-400","aria-hidden":"true"})]})]})})]})]})]})})})}function Ee(){const i=P(),r=L(t=>t.pengirimans.list),{user:l}=H;p.exports.useEffect(()=>{i(B())},[]);const c=t=>{window.confirm("Are you sure you want to remove this pengiriman?")&&i(te(t))},m=p.exports.useMemo(()=>[{Header:"Date",accessor:"createdAt"},{Header:"SuratJalan",accessor:"suratJalan",Cell:t=>{var o,a,n,h;return s("a",{href:`/listpengiriman/detailpengiriman/${(a=(o=t==null?void 0:t.row)==null?void 0:o.original)==null?void 0:a.id}`,className:"hover:text-blue-700 font-semibold hover:text-lg",children:[" ",(h=(n=t==null?void 0:t.row)==null?void 0:n.original)==null?void 0:h.suratJalan," "]})}},{Header:"Driver",accessor:"drivers.fullName",Cell:t=>{var o,a,n;return e("span",{children:(n=(a=(o=t==null?void 0:t.row)==null?void 0:o.original)==null?void 0:a.drivers)==null?void 0:n.fullName})}},{Header:"Kendaraan",accessor:"kendaraans.kendaraan",Cell:t=>{var o,a,n;return e("span",{children:(n=(a=(o=t==null?void 0:t.row)==null?void 0:o.original)==null?void 0:a.kendaraans)==null?void 0:n.kendaraan})}},{Header:"Customer",accessor:"customers.customer",Cell:t=>{var o,a,n;return e("span",{children:(n=(a=(o=t==null?void 0:t.row)==null?void 0:o.original)==null?void 0:a.customers)==null?void 0:n.customer})}},{Header:"Sales",accessor:"customers.salesUser.fullName",Cell:t=>{var o,a,n,h;return e("span",{children:(h=(n=(a=(o=t==null?void 0:t.row)==null?void 0:o.original)==null?void 0:a.customers)==null?void 0:n.salesUser)==null?void 0:h.fullName})}},{Header:"Status",accessor:"status",Cell:fe},{Header:"Action",Cell:t=>{var o,a,n,h,y,k,N,v,d;return s("div",{className:"flex justify-start",children:[((o=E.update_pengiriman)==null?void 0:o.allowedRoles.includes(l==null?void 0:l.role))&&((h=E.update_pengiriman[`allowedStatus_${l==null?void 0:l.role}`])==null?void 0:h.includes((n=(a=t==null?void 0:t.row)==null?void 0:a.original)==null?void 0:n.status))&&e(he,{id:(k=(y=t==null?void 0:t.row)==null?void 0:y.original)==null?void 0:k.id,status:(v=(N=t==null?void 0:t.row)==null?void 0:N.original)==null?void 0:v.status}),((d=E.delete_pengiriman)==null?void 0:d.allowedRoles.includes(l==null?void 0:l.role))&&e("svg",{onClick:()=>{var g,w;return c((w=(g=t==null?void 0:t.row)==null?void 0:g.original)==null?void 0:w.id)},xmlns:"http://www.w3.org/2000/svg",className:"w-6 h-6 text-red-400 cursor-pointer",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})]})}}],[]);return e(ve,{columns:m,data:r})}export{Ee as default};
